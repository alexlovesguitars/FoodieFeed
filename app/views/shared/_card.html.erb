
<div class="card-resize">
  <div class="card-category">
    <div class="photo">
      <% if user_signed_in? && recipe.present? %>
        <% favorite = current_user.favorites.find_by(recipe_id: recipe.id) %>
        <% if favorite %>
          <%= link_to favorite_path(favorite),
                      data: { turbo_method: :delete },
                      class: "favorite-link" do %>
            <i class="fa-solid fa-heart favorite-icon"></i>
          <% end %>
        <% else %>
          <%= link_to favorites_path(recipe_id: recipe.id),
                      data: { turbo_method: :post },
                      class: "favorite-link" do %>
            <i class="fa-regular fa-heart favorite-icon"></i>
          <% end %>
        <% end %>
      <% end %>
      <% if recipe.present? && recipe.image.present? && recipe.image.key? %>
        <%= cl_image_tag(recipe.image.key, gravity: "auto", width: 298, height: 220, crop: "auto", class: "img-fluid justify-content-center") %>
      <% end %>
    </div>
    <div class="content d-flex justify-content-between align-items-center">
      <% if recipe.present? %>
        <h4 class="card-title"><%= recipe.title %></h4>
      <% end %>
      <% if recipe.present? && recipe.user.present? %>
        <a href="<%= user_path(recipe.user) %>" class="avatar-card">
          <% if recipe.user.avatar.present? && recipe.user.avatar.key? %>
            <%= cl_image_tag(recipe.user.avatar.key, class: "avatar-card", transformation: [
              {gravity: "face", height: 200, width: 200, crop: "thumb"},
              {radius: "max"},
              {fetch_format: "auto"}
            ]) %>
          <% else %>
            <i class="fa-solid fa-user avatar-card"></i>
          <% end %>
        </a>
      <% end %>
    </div>
  </div>
</div>

<!-- Render Modals -->
<% if @recipes.present? %>
  <% @recipes.each do |recipe| %>
    <%= render "shared/modal", recipe: recipe %>
  <% end %>
<% end %>
